---
layout: single
title: "22.05.19 - Movie Finder 리팩토링"
categories: TIL
tag: [react]
---

## Today

- Movie Finder Spinner 렌더링 및 무한 스크롤링
- 프리온보딩 과제 merge

<br/>

## Position: fixed

Position 속성값 중 fixed는 viewport를 참조한다. 헷갈리지 말자.

<br/>

## IntersectionObserver

```typescript
const observer: any = useRef();
const lastElementRef = useCallback(
  (node: HTMLLIElement) => {
    if (loading) return;
    if (observer.current) observer.current.disconnect();
    observer.current = new IntersectionObserver((entries) => {
      if (entries[0].isIntersecting && hasMore) {
        setLoading(true);
        setTimeout(() => {
          setPage((prevPage) => prevPage + 1);
        }, 800);
      }
    });
    if (node) observer.current.observe(node);
  },
  [loading, hasMore, setLoading]
);

<List
  lastElementRef={lastElementRef}
  isFavorite={!!isFavoriteBool}
  handleClickList={handleClickList}
  key={item.imdbID}
  data={item}
/>;
```

- observer를 useRef로 정의하는 이유는 매번 렌더링 될 때마다 새로운 observer를 생성하고 싶지 않기 때문이다.
- lastElementRef 함수를 마지막 아이템에 ref 속성에 달았다. 그럼 ref 속성을 가진 마지막 원소가 렌더링 될 때 위 함수가 실행된다.
